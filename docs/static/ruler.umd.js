(function(X,$){typeof exports=="object"&&typeof module<"u"?$(exports):typeof define=="function"&&define.amd?define(["exports"],$):(X=typeof globalThis<"u"?globalThis:X||self,$(X.Ruler={}))})(this,function(X){"use strict";var Fi=Object.defineProperty;var zi=(X,$,q)=>$ in X?Fi(X,$,{enumerable:!0,configurable:!0,writable:!0,value:q}):X[$]=q;var y=(X,$,q)=>zi(X,typeof $!="symbol"?$+"":$,q);var $="http://www.w3.org/1999/xhtml";const q={svg:"http://www.w3.org/2000/svg",xhtml:$,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Pt(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),q.hasOwnProperty(e)?{space:q[e],local:t}:t}function ve(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===$&&e.documentElement.namespaceURI===$?e.createElement(t):e.createElementNS(n,t)}}function Me(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function xt(t){var e=Pt(t);return(e.local?Me:ve)(e)}function ke(){}function Ot(t){return t==null?ke:function(){return this.querySelector(t)}}function Ae(t){typeof t!="function"&&(t=Ot(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],o=s.length,a=r[i]=new Array(o),l,u,f=0;f<o;++f)(l=s[f])&&(u=t.call(l,l.__data__,f,s))&&("__data__"in l&&(u.__data__=l.__data__),a[f]=u);return new T(r,this._parents)}function Ne(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function $e(){return[]}function Re(t){return t==null?$e:function(){return this.querySelectorAll(t)}}function Se(t){return function(){return Ne(t.apply(this,arguments))}}function Ee(t){typeof t=="function"?t=Se(t):t=Re(t);for(var e=this._groups,n=e.length,r=[],i=[],s=0;s<n;++s)for(var o=e[s],a=o.length,l,u=0;u<a;++u)(l=o[u])&&(r.push(t.call(l,l.__data__,u,o)),i.push(l));return new T(r,i)}function Le(t){return function(){return this.matches(t)}}function Ft(t){return function(e){return e.matches(t)}}var Xe=Array.prototype.find;function Ce(t){return function(){return Xe.call(this.children,t)}}function Te(){return this.firstElementChild}function De(t){return this.select(t==null?Te:Ce(typeof t=="function"?t:Ft(t)))}var Pe=Array.prototype.filter;function Oe(){return Array.from(this.children)}function Fe(t){return function(){return Pe.call(this.children,t)}}function ze(t){return this.selectAll(t==null?Oe:Fe(typeof t=="function"?t:Ft(t)))}function He(t){typeof t!="function"&&(t=Le(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],o=s.length,a=r[i]=[],l,u=0;u<o;++u)(l=s[u])&&t.call(l,l.__data__,u,s)&&a.push(l);return new T(r,this._parents)}function zt(t){return new Array(t.length)}function qe(){return new T(this._enter||this._groups.map(zt),this._parents)}function nt(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}nt.prototype={constructor:nt,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function Ie(t){return function(){return t}}function Be(t,e,n,r,i,s){for(var o=0,a,l=e.length,u=s.length;o<u;++o)(a=e[o])?(a.__data__=s[o],r[o]=a):n[o]=new nt(t,s[o]);for(;o<l;++o)(a=e[o])&&(i[o]=a)}function Ve(t,e,n,r,i,s,o){var a,l,u=new Map,f=e.length,d=s.length,c=new Array(f),g;for(a=0;a<f;++a)(l=e[a])&&(c[a]=g=o.call(l,l.__data__,a,e)+"",u.has(g)?i[a]=l:u.set(g,l));for(a=0;a<d;++a)g=o.call(t,s[a],a,s)+"",(l=u.get(g))?(r[a]=l,l.__data__=s[a],u.delete(g)):n[a]=new nt(t,s[a]);for(a=0;a<f;++a)(l=e[a])&&u.get(c[a])===l&&(i[a]=l)}function Ue(t){return t.__data__}function Ye(t,e){if(!arguments.length)return Array.from(this,Ue);var n=e?Ve:Be,r=this._parents,i=this._groups;typeof t!="function"&&(t=Ie(t));for(var s=i.length,o=new Array(s),a=new Array(s),l=new Array(s),u=0;u<s;++u){var f=r[u],d=i[u],c=d.length,g=Ge(t.call(f,f&&f.__data__,u,r)),w=g.length,D=a[u]=new Array(w),L=o[u]=new Array(w),C=l[u]=new Array(c);n(f,d,D,L,C,g,e);for(var N=0,v=0,h,p;N<w;++N)if(h=D[N]){for(N>=v&&(v=N+1);!(p=L[v])&&++v<w;);h._next=p||null}}return o=new T(o,r),o._enter=a,o._exit=l,o}function Ge(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Ke(){return new T(this._exit||this._groups.map(zt),this._parents)}function Ze(t,e,n){var r=this.enter(),i=this,s=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(i=e(i),i&&(i=i.selection())),n==null?s.remove():n(s),r&&i?r.merge(i).order():i}function Je(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,s=r.length,o=Math.min(i,s),a=new Array(i),l=0;l<o;++l)for(var u=n[l],f=r[l],d=u.length,c=a[l]=new Array(d),g,w=0;w<d;++w)(g=u[w]||f[w])&&(c[w]=g);for(;l<i;++l)a[l]=n[l];return new T(a,this._parents)}function Qe(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],i=r.length-1,s=r[i],o;--i>=0;)(o=r[i])&&(s&&o.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(o,s),s=o);return this}function We(t){t||(t=je);function e(d,c){return d&&c?t(d.__data__,c.__data__):!d-!c}for(var n=this._groups,r=n.length,i=new Array(r),s=0;s<r;++s){for(var o=n[s],a=o.length,l=i[s]=new Array(a),u,f=0;f<a;++f)(u=o[f])&&(l[f]=u);l.sort(e)}return new T(i,this._parents).order()}function je(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function tn(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function en(){return Array.from(this)}function nn(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,s=r.length;i<s;++i){var o=r[i];if(o)return o}return null}function rn(){let t=0;for(const e of this)++t;return t}function sn(){return!this.node()}function on(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],s=0,o=i.length,a;s<o;++s)(a=i[s])&&t.call(a,a.__data__,s,i);return this}function an(t){return function(){this.removeAttribute(t)}}function un(t){return function(){this.removeAttributeNS(t.space,t.local)}}function ln(t,e){return function(){this.setAttribute(t,e)}}function cn(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function fn(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function hn(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function dn(t,e){var n=Pt(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?un:an:typeof e=="function"?n.local?hn:fn:n.local?cn:ln)(n,e))}function Ht(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function gn(t){return function(){this.style.removeProperty(t)}}function mn(t,e,n){return function(){this.style.setProperty(t,e,n)}}function pn(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function yn(t,e,n){return arguments.length>1?this.each((e==null?gn:typeof e=="function"?pn:mn)(t,e,n??"")):xn(this.node(),t)}function xn(t,e){return t.style.getPropertyValue(e)||Ht(t).getComputedStyle(t,null).getPropertyValue(e)}function _n(t){return function(){delete this[t]}}function wn(t,e){return function(){this[t]=e}}function bn(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function vn(t,e){return arguments.length>1?this.each((e==null?_n:typeof e=="function"?bn:wn)(t,e)):this.node()[t]}function qt(t){return t.trim().split(/^|\s+/)}function _t(t){return t.classList||new It(t)}function It(t){this._node=t,this._names=qt(t.getAttribute("class")||"")}It.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function Bt(t,e){for(var n=_t(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function Vt(t,e){for(var n=_t(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function Mn(t){return function(){Bt(this,t)}}function kn(t){return function(){Vt(this,t)}}function An(t,e){return function(){(e.apply(this,arguments)?Bt:Vt)(this,t)}}function Nn(t,e){var n=qt(t+"");if(arguments.length<2){for(var r=_t(this.node()),i=-1,s=n.length;++i<s;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof e=="function"?An:e?Mn:kn)(n,e))}function $n(){this.textContent=""}function Rn(t){return function(){this.textContent=t}}function Sn(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function En(t){return arguments.length?this.each(t==null?$n:(typeof t=="function"?Sn:Rn)(t)):this.node().textContent}function Ln(){this.innerHTML=""}function Xn(t){return function(){this.innerHTML=t}}function Cn(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function Tn(t){return arguments.length?this.each(t==null?Ln:(typeof t=="function"?Cn:Xn)(t)):this.node().innerHTML}function Dn(){this.nextSibling&&this.parentNode.appendChild(this)}function Pn(){return this.each(Dn)}function On(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Fn(){return this.each(On)}function zn(t){var e=typeof t=="function"?t:xt(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function Hn(){return null}function qn(t,e){var n=typeof t=="function"?t:xt(t),r=e==null?Hn:typeof e=="function"?e:Ot(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function In(){var t=this.parentNode;t&&t.removeChild(this)}function Bn(){return this.each(In)}function Vn(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Un(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Yn(t){return this.select(t?Un:Vn)}function Gn(t){return arguments.length?this.property("__data__",t):this.node().__data__}function Kn(t){return function(e){t.call(this,e,this.__data__)}}function Zn(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function Jn(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,i=e.length,s;n<i;++n)s=e[n],(!t.type||s.type===t.type)&&s.name===t.name?this.removeEventListener(s.type,s.listener,s.options):e[++r]=s;++r?e.length=r:delete this.__on}}}function Qn(t,e,n){return function(){var r=this.__on,i,s=Kn(e);if(r){for(var o=0,a=r.length;o<a;++o)if((i=r[o]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=n),i.value=e;return}}this.addEventListener(t.type,s,n),i={type:t.type,name:t.name,value:e,listener:s,options:n},r?r.push(i):this.__on=[i]}}function Wn(t,e,n){var r=Zn(t+""),i,s=r.length,o;if(arguments.length<2){var a=this.node().__on;if(a){for(var l=0,u=a.length,f;l<u;++l)for(i=0,f=a[l];i<s;++i)if((o=r[i]).type===f.type&&o.name===f.name)return f.value}return}for(a=e?Qn:Jn,i=0;i<s;++i)this.each(a(r[i],e,n));return this}function Ut(t,e,n){var r=Ht(t),i=r.CustomEvent;typeof i=="function"?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function jn(t,e){return function(){return Ut(this,t,e)}}function tr(t,e){return function(){return Ut(this,t,e.apply(this,arguments))}}function er(t,e){return this.each((typeof e=="function"?tr:jn)(t,e))}function*nr(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,s=r.length,o;i<s;++i)(o=r[i])&&(yield o)}var rr=[null];function T(t,e){this._groups=t,this._parents=e}function ir(){return this}T.prototype={constructor:T,select:Ae,selectAll:Ee,selectChild:De,selectChildren:ze,filter:He,data:Ye,enter:qe,exit:Ke,join:Ze,merge:Je,selection:ir,order:Qe,sort:We,call:tn,nodes:en,node:nn,size:rn,empty:sn,each:on,attr:dn,style:yn,property:vn,classed:Nn,text:En,html:Tn,raise:Pn,lower:Fn,append:zn,insert:qn,remove:Bn,clone:Yn,datum:Gn,on:Wn,dispatch:er,[Symbol.iterator]:nr};function U(t){return typeof t=="string"?new T([[document.querySelector(t)]],[document.documentElement]):new T([[t]],rr)}function sr(t){return U(xt(t).call(document.documentElement))}function or(t){let e;for(;e=t.sourceEvent;)t=e;return t}function wt(t,e){if(t=or(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}if(e.getBoundingClientRect){var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]}}return[t.pageX,t.pageY]}var ar={value:()=>{}};function Yt(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new rt(n)}function rt(t){this._=t}function ur(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}rt.prototype=Yt.prototype={constructor:rt,on:function(t,e){var n=this._,r=ur(t+"",n),i,s=-1,o=r.length;if(arguments.length<2){for(;++s<o;)if((i=(t=r[s]).type)&&(i=lr(n[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++s<o;)if(i=(t=r[s]).type)n[i]=Gt(n[i],t.name,e);else if(e==null)for(i in n)n[i]=Gt(n[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new rt(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,s;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=this._[t],r=0,i=s.length;r<i;++r)s[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,s=r.length;i<s;++i)r[i].value.apply(e,n)}};function lr(t,e){for(var n=0,r=t.length,i;n<r;++n)if((i=t[n]).name===e)return i.value}function Gt(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=ar,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}const cr={passive:!1},Q={capture:!0,passive:!1};function bt(t){t.stopImmediatePropagation()}function Y(t){t.preventDefault(),t.stopImmediatePropagation()}function fr(t){var e=t.document.documentElement,n=U(t).on("dragstart.drag",Y,Q);"onselectstart"in e?n.on("selectstart.drag",Y,Q):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function hr(t,e){var n=t.document.documentElement,r=U(t).on("dragstart.drag",null);e&&(r.on("click.drag",Y,Q),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const it=t=>()=>t;function vt(t,{sourceEvent:e,subject:n,target:r,identifier:i,active:s,x:o,y:a,dx:l,dy:u,dispatch:f}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:o,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:f}})}vt.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function dr(t){return!t.ctrlKey&&!t.button}function gr(){return this.parentNode}function mr(t,e){return e??{x:t.x,y:t.y}}function pr(){return navigator.maxTouchPoints||"ontouchstart"in this}function yr(){var t=dr,e=gr,n=mr,r=pr,i={},s=Yt("start","drag","end"),o=0,a,l,u,f,d=0;function c(h){h.on("mousedown.drag",g).filter(r).on("touchstart.drag",L).on("touchmove.drag",C,cr).on("touchend.drag touchcancel.drag",N).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function g(h,p){if(!(f||!t.call(this,h,p))){var _=v(this,e.call(this,h,p),h,p,"mouse");_&&(U(h.view).on("mousemove.drag",w,Q).on("mouseup.drag",D,Q),fr(h.view),bt(h),u=!1,a=h.clientX,l=h.clientY,_("start",h))}}function w(h){if(Y(h),!u){var p=h.clientX-a,_=h.clientY-l;u=p*p+_*_>d}i.mouse("drag",h)}function D(h){U(h.view).on("mousemove.drag mouseup.drag",null),hr(h.view,u),Y(h),i.mouse("end",h)}function L(h,p){if(t.call(this,h,p)){var _=h.changedTouches,x=e.call(this,h,p),k=_.length,R,S;for(R=0;R<k;++R)(S=v(this,x,h,p,_[R].identifier,_[R]))&&(bt(h),S("start",h,_[R]))}}function C(h){var p=h.changedTouches,_=p.length,x,k;for(x=0;x<_;++x)(k=i[p[x].identifier])&&(Y(h),k("drag",h,p[x]))}function N(h){var p=h.changedTouches,_=p.length,x,k;for(f&&clearTimeout(f),f=setTimeout(function(){f=null},500),x=0;x<_;++x)(k=i[p[x].identifier])&&(bt(h),k("end",h,p[x]))}function v(h,p,_,x,k,R){var S=s.copy(),m=wt(R||_,p),A,M,F;if((F=n.call(h,new vt("beforestart",{sourceEvent:_,target:c,identifier:k,active:o,x:m[0],y:m[1],dx:0,dy:0,dispatch:S}),x))!=null)return A=F.x-m[0]||0,M=F.y-m[1]||0,function yt(H,V,J){var P=m,Dt;switch(H){case"start":i[k]=yt,Dt=o++;break;case"end":delete i[k],--o;case"drag":m=wt(J||V,p),Dt=o;break}S.call(H,h,new vt(H,{sourceEvent:V,subject:F,target:c,identifier:k,active:Dt,x:m[0]+A,y:m[1]+M,dx:m[0]-P[0],dy:m[1]-P[1],dispatch:S}),x)}}return c.filter=function(h){return arguments.length?(t=typeof h=="function"?h:it(!!h),c):t},c.container=function(h){return arguments.length?(e=typeof h=="function"?h:it(h),c):e},c.subject=function(h){return arguments.length?(n=typeof h=="function"?h:it(h),c):n},c.touchable=function(h){return arguments.length?(r=typeof h=="function"?h:it(!!h),c):r},c.on=function(){var h=s.on.apply(s,arguments);return h===s?c:h},c.clickDistance=function(h){return arguments.length?(d=(h=+h)*h,c):Math.sqrt(d)},c}function xr(t){return t}var Mt=1,st=2,kt=3,ot=4,Kt=1e-6;function _r(t){return"translate("+t+",0)"}function wr(t){return"translate(0,"+t+")"}function br(t){return e=>+t(e)}function vr(t,e){return e=Math.max(0,t.bandwidth()-e*2)/2,t.round()&&(e=Math.round(e)),n=>+t(n)+e}function Mr(){return!this.__axis}function Zt(t,e){var n=[],r=null,i=null,s=6,o=6,a=3,l=typeof window<"u"&&window.devicePixelRatio>1?0:.5,u=t===Mt||t===ot?-1:1,f=t===ot||t===st?"x":"y",d=t===Mt||t===kt?_r:wr;function c(g){var w=r??(e.ticks?e.ticks.apply(e,n):e.domain()),D=i??(e.tickFormat?e.tickFormat.apply(e,n):xr),L=Math.max(s,0)+a,C=e.range(),N=+C[0]+l,v=+C[C.length-1]+l,h=(e.bandwidth?vr:br)(e.copy(),l),p=g.selection?g.selection():g,_=p.selectAll(".domain").data([null]),x=p.selectAll(".tick").data(w,e).order(),k=x.exit(),R=x.enter().append("g").attr("class","tick"),S=x.select("line"),m=x.select("text");_=_.merge(_.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),x=x.merge(R),S=S.merge(R.append("line").attr("stroke","currentColor").attr(f+"2",u*s)),m=m.merge(R.append("text").attr("fill","currentColor").attr(f,u*L).attr("dy",t===Mt?"0em":t===kt?"0.71em":"0.32em")),g!==p&&(_=_.transition(g),x=x.transition(g),S=S.transition(g),m=m.transition(g),k=k.transition(g).attr("opacity",Kt).attr("transform",function(A){return isFinite(A=h(A))?d(A+l):this.getAttribute("transform")}),R.attr("opacity",Kt).attr("transform",function(A){var M=this.parentNode.__axis;return d((M&&isFinite(M=M(A))?M:h(A))+l)})),k.remove(),_.attr("d",t===ot||t===st?o?"M"+u*o+","+N+"H"+l+"V"+v+"H"+u*o:"M"+l+","+N+"V"+v:o?"M"+N+","+u*o+"V"+l+"H"+v+"V"+u*o:"M"+N+","+l+"H"+v),x.attr("opacity",1).attr("transform",function(A){return d(h(A)+l)}),S.attr(f+"2",u*s),m.attr(f,u*L).text(D),p.filter(Mr).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===st?"start":t===ot?"end":"middle"),p.each(function(){this.__axis=h})}return c.scale=function(g){return arguments.length?(e=g,c):e},c.ticks=function(){return n=Array.from(arguments),c},c.tickArguments=function(g){return arguments.length?(n=g==null?[]:Array.from(g),c):n.slice()},c.tickValues=function(g){return arguments.length?(r=g==null?null:Array.from(g),c):r&&r.slice()},c.tickFormat=function(g){return arguments.length?(i=g,c):i},c.tickSize=function(g){return arguments.length?(s=o=+g,c):s},c.tickSizeInner=function(g){return arguments.length?(s=+g,c):s},c.tickSizeOuter=function(g){return arguments.length?(o=+g,c):o},c.tickPadding=function(g){return arguments.length?(a=+g,c):a},c.offset=function(g){return arguments.length?(l=+g,c):l},c}function kr(t){return Zt(st,t)}function Ar(t){return Zt(kt,t)}function at(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Nr(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Jt(t){let e,n,r;t.length!==2?(e=at,n=(a,l)=>at(t(a),l),r=(a,l)=>t(a)-l):(e=t===at||t===Nr?t:$r,n=t,r=t);function i(a,l,u=0,f=a.length){if(u<f){if(e(l,l)!==0)return f;do{const d=u+f>>>1;n(a[d],l)<0?u=d+1:f=d}while(u<f)}return u}function s(a,l,u=0,f=a.length){if(u<f){if(e(l,l)!==0)return f;do{const d=u+f>>>1;n(a[d],l)<=0?u=d+1:f=d}while(u<f)}return u}function o(a,l,u=0,f=a.length){const d=i(a,l,u,f-1);return d>u&&r(a[d-1],l)>-r(a[d],l)?d-1:d}return{left:i,center:o,right:s}}function $r(){return 0}function Rr(t){return t===null?NaN:+t}const Sr=Jt(at).right;Jt(Rr).center;const Er=Math.sqrt(50),Lr=Math.sqrt(10),Xr=Math.sqrt(2);function ut(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),s=r/Math.pow(10,i),o=s>=Er?10:s>=Lr?5:s>=Xr?2:1;let a,l,u;return i<0?(u=Math.pow(10,-i)/o,a=Math.round(t*u),l=Math.round(e*u),a/u<t&&++a,l/u>e&&--l,u=-u):(u=Math.pow(10,i)*o,a=Math.round(t/u),l=Math.round(e/u),a*u<t&&++a,l*u>e&&--l),l<a&&.5<=n&&n<2?ut(t,e,n*2):[a,l,u]}function Cr(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const r=e<t,[i,s,o]=r?ut(e,t,n):ut(t,e,n);if(!(s>=i))return[];const a=s-i+1,l=new Array(a);if(r)if(o<0)for(let u=0;u<a;++u)l[u]=(s-u)/-o;else for(let u=0;u<a;++u)l[u]=(s-u)*o;else if(o<0)for(let u=0;u<a;++u)l[u]=(i+u)/-o;else for(let u=0;u<a;++u)l[u]=(i+u)*o;return l}function At(t,e,n){return e=+e,t=+t,n=+n,ut(t,e,n)[2]}function Tr(t,e,n){e=+e,t=+t,n=+n;const r=e<t,i=r?At(e,t,n):At(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}function Dr(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function Nt(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Qt(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function W(){}var j=.7,lt=1/j,G="\\s*([+-]?\\d+)\\s*",tt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",z="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Pr=/^#([0-9a-f]{3,8})$/,Or=new RegExp(`^rgb\\(${G},${G},${G}\\)$`),Fr=new RegExp(`^rgb\\(${z},${z},${z}\\)$`),zr=new RegExp(`^rgba\\(${G},${G},${G},${tt}\\)$`),Hr=new RegExp(`^rgba\\(${z},${z},${z},${tt}\\)$`),qr=new RegExp(`^hsl\\(${tt},${z},${z}\\)$`),Ir=new RegExp(`^hsla\\(${tt},${z},${z},${tt}\\)$`),Wt={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Nt(W,et,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:jt,formatHex:jt,formatHex8:Br,formatHsl:Vr,formatRgb:te,toString:te});function jt(){return this.rgb().formatHex()}function Br(){return this.rgb().formatHex8()}function Vr(){return se(this).formatHsl()}function te(){return this.rgb().formatRgb()}function et(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Pr.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?ee(e):n===3?new E(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?ct(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?ct(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Or.exec(t))?new E(e[1],e[2],e[3],1):(e=Fr.exec(t))?new E(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=zr.exec(t))?ct(e[1],e[2],e[3],e[4]):(e=Hr.exec(t))?ct(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=qr.exec(t))?ie(e[1],e[2]/100,e[3]/100,1):(e=Ir.exec(t))?ie(e[1],e[2]/100,e[3]/100,e[4]):Wt.hasOwnProperty(t)?ee(Wt[t]):t==="transparent"?new E(NaN,NaN,NaN,0):null}function ee(t){return new E(t>>16&255,t>>8&255,t&255,1)}function ct(t,e,n,r){return r<=0&&(t=e=n=NaN),new E(t,e,n,r)}function Ur(t){return t instanceof W||(t=et(t)),t?(t=t.rgb(),new E(t.r,t.g,t.b,t.opacity)):new E}function $t(t,e,n,r){return arguments.length===1?Ur(t):new E(t,e,n,r??1)}function E(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}Nt(E,$t,Qt(W,{brighter(t){return t=t==null?lt:Math.pow(lt,t),new E(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?j:Math.pow(j,t),new E(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new E(I(this.r),I(this.g),I(this.b),ft(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ne,formatHex:ne,formatHex8:Yr,formatRgb:re,toString:re}));function ne(){return`#${B(this.r)}${B(this.g)}${B(this.b)}`}function Yr(){return`#${B(this.r)}${B(this.g)}${B(this.b)}${B((isNaN(this.opacity)?1:this.opacity)*255)}`}function re(){const t=ft(this.opacity);return`${t===1?"rgb(":"rgba("}${I(this.r)}, ${I(this.g)}, ${I(this.b)}${t===1?")":`, ${t})`}`}function ft(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function I(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function B(t){return t=I(t),(t<16?"0":"")+t.toString(16)}function ie(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new O(t,e,n,r)}function se(t){if(t instanceof O)return new O(t.h,t.s,t.l,t.opacity);if(t instanceof W||(t=et(t)),!t)return new O;if(t instanceof O)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),s=Math.max(e,n,r),o=NaN,a=s-i,l=(s+i)/2;return a?(e===s?o=(n-r)/a+(n<r)*6:n===s?o=(r-e)/a+2:o=(e-n)/a+4,a/=l<.5?s+i:2-s-i,o*=60):a=l>0&&l<1?0:o,new O(o,a,l,t.opacity)}function Gr(t,e,n,r){return arguments.length===1?se(t):new O(t,e,n,r??1)}function O(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}Nt(O,Gr,Qt(W,{brighter(t){return t=t==null?lt:Math.pow(lt,t),new O(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?j:Math.pow(j,t),new O(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new E(Rt(t>=240?t-240:t+120,i,r),Rt(t,i,r),Rt(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new O(oe(this.h),ht(this.s),ht(this.l),ft(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=ft(this.opacity);return`${t===1?"hsl(":"hsla("}${oe(this.h)}, ${ht(this.s)*100}%, ${ht(this.l)*100}%${t===1?")":`, ${t})`}`}}));function oe(t){return t=(t||0)%360,t<0?t+360:t}function ht(t){return Math.max(0,Math.min(1,t||0))}function Rt(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const St=t=>()=>t;function Kr(t,e){return function(n){return t+n*e}}function Zr(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function Jr(t){return(t=+t)==1?ae:function(e,n){return n-e?Zr(e,n,t):St(isNaN(e)?n:e)}}function ae(t,e){var n=e-t;return n?Kr(t,n):St(isNaN(t)?e:t)}const ue=function t(e){var n=Jr(e);function r(i,s){var o=n((i=$t(i)).r,(s=$t(s)).r),a=n(i.g,s.g),l=n(i.b,s.b),u=ae(i.opacity,s.opacity);return function(f){return i.r=o(f),i.g=a(f),i.b=l(f),i.opacity=u(f),i+""}}return r.gamma=t,r}(1);function Qr(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),i;return function(s){for(i=0;i<n;++i)r[i]=t[i]*(1-s)+e[i]*s;return r}}function Wr(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function jr(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,i=new Array(r),s=new Array(n),o;for(o=0;o<r;++o)i[o]=Xt(t[o],e[o]);for(;o<n;++o)s[o]=e[o];return function(a){for(o=0;o<r;++o)s[o]=i[o](a);return s}}function ti(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function dt(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function ei(t,e){var n={},r={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?n[i]=Xt(t[i],e[i]):r[i]=e[i];return function(s){for(i in n)r[i]=n[i](s);return r}}var Et=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Lt=new RegExp(Et.source,"g");function ni(t){return function(){return t}}function ri(t){return function(e){return t(e)+""}}function ii(t,e){var n=Et.lastIndex=Lt.lastIndex=0,r,i,s,o=-1,a=[],l=[];for(t=t+"",e=e+"";(r=Et.exec(t))&&(i=Lt.exec(e));)(s=i.index)>n&&(s=e.slice(n,s),a[o]?a[o]+=s:a[++o]=s),(r=r[0])===(i=i[0])?a[o]?a[o]+=i:a[++o]=i:(a[++o]=null,l.push({i:o,x:dt(r,i)})),n=Lt.lastIndex;return n<e.length&&(s=e.slice(n),a[o]?a[o]+=s:a[++o]=s),a.length<2?l[0]?ri(l[0].x):ni(e):(e=l.length,function(u){for(var f=0,d;f<e;++f)a[(d=l[f]).i]=d.x(u);return a.join("")})}function Xt(t,e){var n=typeof e,r;return e==null||n==="boolean"?St(e):(n==="number"?dt:n==="string"?(r=et(e))?(e=r,ue):ii:e instanceof et?ue:e instanceof Date?ti:Wr(e)?Qr:Array.isArray(e)?jr:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?ei:dt)(t,e)}function si(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function oi(t){return function(){return t}}function ai(t){return+t}var le=[0,1];function K(t){return t}function Ct(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:oi(isNaN(e)?NaN:.5)}function ui(t,e){var n;return t>e&&(n=t,t=e,e=n),function(r){return Math.max(t,Math.min(e,r))}}function li(t,e,n){var r=t[0],i=t[1],s=e[0],o=e[1];return i<r?(r=Ct(i,r),s=n(o,s)):(r=Ct(r,i),s=n(s,o)),function(a){return s(r(a))}}function ci(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),s=new Array(r),o=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<r;)i[o]=Ct(t[o],t[o+1]),s[o]=n(e[o],e[o+1]);return function(a){var l=Sr(t,a,1,r)-1;return s[l](i[l](a))}}function fi(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function hi(){var t=le,e=le,n=Xt,r,i,s,o=K,a,l,u;function f(){var c=Math.min(t.length,e.length);return o!==K&&(o=ui(t[0],t[c-1])),a=c>2?ci:li,l=u=null,d}function d(c){return c==null||isNaN(c=+c)?s:(l||(l=a(t.map(r),e,n)))(r(o(c)))}return d.invert=function(c){return o(i((u||(u=a(e,t.map(r),dt)))(c)))},d.domain=function(c){return arguments.length?(t=Array.from(c,ai),f()):t.slice()},d.range=function(c){return arguments.length?(e=Array.from(c),f()):e.slice()},d.rangeRound=function(c){return e=Array.from(c),n=si,f()},d.clamp=function(c){return arguments.length?(o=c?!0:K,f()):o!==K},d.interpolate=function(c){return arguments.length?(n=c,f()):n},d.unknown=function(c){return arguments.length?(s=c,d):s},function(c,g){return r=c,i=g,f()}}function di(){return hi()(K,K)}function gi(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function gt(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function Z(t){return t=gt(Math.abs(t)),t?t[1]:NaN}function mi(t,e){return function(n,r){for(var i=n.length,s=[],o=0,a=t[0],l=0;i>0&&a>0&&(l+a+1>r&&(a=Math.max(1,r-l)),s.push(n.substring(i-=a,i+a)),!((l+=a+1)>r));)a=t[o=(o+1)%t.length];return s.reverse().join(e)}}function pi(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var yi=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function mt(t){if(!(e=yi.exec(t)))throw new Error("invalid format: "+t);var e;return new Tt({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}mt.prototype=Tt.prototype;function Tt(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}Tt.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function xi(t){t:for(var e=t.length,n=1,r=-1,i;n<e;++n)switch(t[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+t[n])break t;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var ce;function _i(t,e){var n=gt(t,e);if(!n)return t+"";var r=n[0],i=n[1],s=i-(ce=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=r.length;return s===o?r:s>o?r+new Array(s-o+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+gt(t,Math.max(0,e+s-1))[0]}function fe(t,e){var n=gt(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const he={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:gi,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>fe(t*100,e),r:fe,s:_i,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function de(t){return t}var ge=Array.prototype.map,me=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function wi(t){var e=t.grouping===void 0||t.thousands===void 0?de:mi(ge.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",s=t.numerals===void 0?de:pi(ge.call(t.numerals,String)),o=t.percent===void 0?"%":t.percent+"",a=t.minus===void 0?"−":t.minus+"",l=t.nan===void 0?"NaN":t.nan+"";function u(d){d=mt(d);var c=d.fill,g=d.align,w=d.sign,D=d.symbol,L=d.zero,C=d.width,N=d.comma,v=d.precision,h=d.trim,p=d.type;p==="n"?(N=!0,p="g"):he[p]||(v===void 0&&(v=12),h=!0,p="g"),(L||c==="0"&&g==="=")&&(L=!0,c="0",g="=");var _=D==="$"?n:D==="#"&&/[boxX]/.test(p)?"0"+p.toLowerCase():"",x=D==="$"?r:/[%p]/.test(p)?o:"",k=he[p],R=/[defgprs%]/.test(p);v=v===void 0?6:/[gprs]/.test(p)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v));function S(m){var A=_,M=x,F,yt,H;if(p==="c")M=k(m)+M,m="";else{m=+m;var V=m<0||1/m<0;if(m=isNaN(m)?l:k(Math.abs(m),v),h&&(m=xi(m)),V&&+m==0&&w!=="+"&&(V=!1),A=(V?w==="("?w:a:w==="-"||w==="("?"":w)+A,M=(p==="s"?me[8+ce/3]:"")+M+(V&&w==="("?")":""),R){for(F=-1,yt=m.length;++F<yt;)if(H=m.charCodeAt(F),48>H||H>57){M=(H===46?i+m.slice(F+1):m.slice(F))+M,m=m.slice(0,F);break}}}N&&!L&&(m=e(m,1/0));var J=A.length+m.length+M.length,P=J<C?new Array(C-J+1).join(c):"";switch(N&&L&&(m=e(P+m,P.length?C-M.length:1/0),P=""),g){case"<":m=A+m+M+P;break;case"=":m=A+P+m+M;break;case"^":m=P.slice(0,J=P.length>>1)+A+m+M+P.slice(J);break;default:m=P+A+m+M;break}return s(m)}return S.toString=function(){return d+""},S}function f(d,c){var g=u((d=mt(d),d.type="f",d)),w=Math.max(-8,Math.min(8,Math.floor(Z(c)/3)))*3,D=Math.pow(10,-w),L=me[8+w/3];return function(C){return g(D*C)+L}}return{format:u,formatPrefix:f}}var pt,pe,ye;bi({thousands:",",grouping:[3],currency:["$",""]});function bi(t){return pt=wi(t),pe=pt.format,ye=pt.formatPrefix,pt}function vi(t){return Math.max(0,-Z(Math.abs(t)))}function Mi(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Z(e)/3)))*3-Z(Math.abs(t)))}function ki(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Z(e)-Z(t))+1}function Ai(t,e,n,r){var i=Tr(t,e,n),s;switch(r=mt(r??",f"),r.type){case"s":{var o=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(s=Mi(i,o))&&(r.precision=s),ye(r,o)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(s=ki(i,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=s-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(s=vi(i))&&(r.precision=s-(r.type==="%")*2);break}}return pe(r)}function Ni(t){var e=t.domain;return t.ticks=function(n){var r=e();return Cr(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){var i=e();return Ai(i[0],i[i.length-1],n??10,r)},t.nice=function(n){n==null&&(n=10);var r=e(),i=0,s=r.length-1,o=r[i],a=r[s],l,u,f=10;for(a<o&&(u=o,o=a,a=u,u=i,i=s,s=u);f-- >0;){if(u=At(o,a,n),u===l)return r[i]=o,r[s]=a,e(r);if(u>0)o=Math.floor(o/u)*u,a=Math.ceil(a/u)*u;else if(u<0)o=Math.ceil(o*u)/u,a=Math.floor(a*u)/u;else break;l=u}return t},t}function xe(){var t=di();return t.copy=function(){return fi(t,xe())},Dr.apply(t,arguments),Ni(t)}class b{}y(b,"create",sr),y(b,"select",U),y(b,"pointer",wt),y(b,"drag",yr),y(b,"scaleLinear",xe),y(b,"axisBottom",Ar),y(b,"axisRight",kr);function $i(){return this.svg.selectAll("text").nodes().map(t=>{if(!t)return 0;const e=t.textContent.replace(/,/g,"").replace(/−/g,"-");return Number(e)||0})}function Ri(){const t=this.getMainTicks(),e=this.svg.selectAll(".tick").nodes().map(i=>{const s=i.getAttribute("transform"),o=this.__isX?s.match(/translate\(([^,]+),/):s.match(/translate\(0,([^,]+)/);return parseFloat(o[1])||0}),n=i=>{const s=[];let o=e[0],a=e[e.length-1];const l=Math.abs(a-o)/(i*(e.length-1));for(;o-l>0;)o-=l;for(;a+l<this.width;)a+=l;for(let u=o;u<=a;u+=l)s.push(u);return s},r=Math.abs(t[0]-t[1]);return r>=10?n(10):r===5?n(5):r>1&&r<5?n(2):n(1)}function Si(t){this.lines.add(Math.round(this.scaleLinear.invert(t))),this.lineRender()}function Ei(t){this.lines.delete(t),this.lineRender()}function Li({scale:t,translateX:e,translateY:n}){const r=this.__isX?e:n,i=Math.max(this.width,this.height),s=0,o=(this.lower-r)/t,a=(this.upper-r)/t;this.scaleLinear=b.scaleLinear([o,a],[s,i]),this.axis.scale(this.scaleLinear),this.svg.call(this.axis);const l=this.getSecondaryTicks();this.svg.selectAll(".ruler-secondary-tick").remove(),this.svg.append("svg:g").lower().classed("ruler-secondary-tick",!0).selectAll("line").data(l).join("svg:line").attr("x1",u=>this.__isX?u:0).attr("y1",u=>this.__isX?0:u).attr("x2",u=>this.__isX?u:5).attr("y2",u=>this.__isX?5:u).attr("stroke","#5EA090").attr("stroke-width","1").style("pointer-events","none"),this.svg.selectAll(".tick").style("pointer-events","none"),this.svg.selectAll(".tick text").attr("text-anchor","start").attr("transform",this.__isX?"translate(4,-6)":"rotate(90) translate(-10, -12)"),this.lineRender(),this.meshRender(),this.svg.select(".domain").remove()}function Xi(){const t=b.drag().on("start",n=>{this.__draggingLine=b.select(n.sourceEvent.target),document.body.style.cursor="col-resize"}).on("drag",n=>{if(!this.__draggingLine)return;const r=n.x,i=n.y,s=this.__draggingLine.datum(),o=Math.round(this.scaleLinear.invert(this.__isX?r:i));this.lines.delete(s),this.__draggingLine.style(this.__isX?"left":"top",`${this.scaleLinear(o)-.4}px`).datum(o),this.lines.add(this.__draggingLine.datum()),this.tooltip.show().fixed(n.sourceEvent.clientX+8,n.sourceEvent.clientY+8).html(`${((this.scaleLinear(this.__draggingLine.datum())-this.scaleLinear(0))*100/(this.__isX?this.observer.boardDOMRect.width:this.observer.boardDOMRect.width)).toFixed(2)}%`)}).on("end",n=>{if(!this.__draggingLine)return;document.body.style.cursor="default",this.tooltip.hidden();const[r,i]=b.pointer(n,this.observer.root);(this.__isX?r:i)<20&&(this.lineRemove(this.__draggingLine.datum()),console.log(this.lines)),this.__draggingLine=null}),e=b.select(this.observer.root);e.selectAll(`.ruler-line-${this.type}`).remove(),e.selectAll(`div[class=ruler-line-${this.type}]`).data(Array.from(this.lines)).join("div").classed(`ruler-line-${this.type}`,!0).style("position","absolute").style("width",this.__isX?"5px":"auto").style("height",this.__isX?"auto":"5px").style("display","flex").style("justify-content","center").style("flex-direction",this.__isX?"row":"column").style("left",n=>this.__isX?`${this.scaleLinear(n)-.4}px`:"20px").style("top",n=>this.__isX?"20px":`${this.scaleLinear(n)-.4}px`).style("transform",this.__isX?"translate(-50%, 0)":"translate(0, -50%)").style("cursor",this.__isX?"col-resize":"row-resize").call(t).append("div").style("width",this.__isX?"1px":`${this.observer.rootDOMRect.width}px`).style("height",this.__isX?`${this.observer.rootDOMRect.height}px`:"1px").style("background","red").style("pointer-events","none")}function _e(){this.observer.root.append(this.svg.node()),this.tooltip.mount()}class Ci{constructor(){y(this,"container",b.create("div").style("position","fixed").style("background","#333").style("color","#FFF").style("padding","3px 5px").style("border-radius","4px").style("pointer-events","none").style("font-size","12px").style("display","none"))}mount(){return document.body.append(this.container.node()),this}unmount(){this.container.remove()}show(){return this.container.style("display","block"),this}hidden(){return this.container.style("display","none"),this}html(e){return this.container.html(e),this}fixed(e,n){return this.container.style("top",`${n}px`).style("left",`${e}px`),this}}function Ti(){this.observer.root.append(this.mesh.node()),this.mesh.lower()}function Di(){this.mesh.remove()}function Pi(){const t=this.getMainTicks();if(Math.abs(t[0]-t[1])<=10){this.meshMount();const e=this.__isX?this.observer.rootDOMRect.height:this.observer.rootDOMRect.width,n=this.getSecondaryTicks();this.mesh.selectAll("line").data(n).join("svg:line").attr("x1",r=>this.__isX?r:0).attr("y1",r=>this.__isX?0:r).attr("x2",r=>this.__isX?r:e).attr("y2",r=>this.__isX?e:r).attr("stroke","#4DA5C9").attr("stroke-width",1)}else this.meshUnmount()}class we{constructor(e,n){y(this,"type");y(this,"svg");y(this,"mesh");y(this,"width");y(this,"height");y(this,"lower");y(this,"upper");y(this,"scaleLinear");y(this,"axis");y(this,"lines",new Set);y(this,"tooltip",new Ci);y(this,"observer");y(this,"__draggingLine",null);y(this,"getMainTicks",$i);y(this,"getSecondaryTicks",Ri);y(this,"lineAdd",Si);y(this,"lineRemove",Ei);y(this,"lineRender",Xi);y(this,"applyTransform",Li);y(this,"mount",_e);y(this,"unmount",_e);y(this,"meshMount",Ti);y(this,"meshUnmount",Di);y(this,"meshRender",Pi);this.observer=n;const r=n.boardCoord,i=Math.max(this.observer.rootDOMRect.width,this.observer.rootDOMRect.height),s=0;this.type=e,this.width=this.__isX?i:20,this.height=this.__isX?20:i,this.lower=-r[e],this.upper=i-r[e],this.scaleLinear=b.scaleLinear([this.lower,this.upper],[s,i]),this.axis=(this.__isX?b.axisBottom(this.scaleLinear):b.axisRight(this.scaleLinear)).ticks(20).tickSize(10).tickPadding(4),this.svg=b.create("svg:svg").attr("viewbox",[0,0,this.width,this.height]).attr("width",this.width).attr("height",this.height).style("background","#DCDCAF").style("position","absolute").style("left",0).style("top",0).call(this.axis),this.svg.on("mousemove",o=>{const[a,l]=b.pointer(o,this.svg.node());this.tooltip.show().fixed(this.__isX?o.clientX+4:this.observer.rootDOMRect.left+24,this.__isX?this.observer.rootDOMRect.height+24:o.clientY+4).html(`${(this.__isX?Math.round(this.scaleLinear.invert(a))*100/this.observer.boardDOMRect.width:Math.round(this.scaleLinear.invert(l))*100/this.observer.boardDOMRect.height).toFixed(2)}%`)}).on("mouseout",()=>{this.tooltip.hidden()}).on("click",o=>{const[a,l]=b.pointer(o,this.svg.node());this.lineAdd(this.__isX?a:l)}),this.mesh=b.create("svg").style("position","absolute").style("left",0).style("top",0).attr("viewBox",[0,0,this.observer.rootDOMRect.width,this.observer.rootDOMRect.height].join(" ")).attr("width",this.observer.rootDOMRect.width).attr("height",this.observer.rootDOMRect.height).style("pointer-events","none"),this.__isX&&this.svg.append("rect").attr("x",0).attr("y",0).attr("width",20).attr("height",20).attr("fill","#DCDCB4")}get __isX(){return this.type==="x"}}class be{constructor(e){y(this,"x");y(this,"y");this.x=new we("x",e),this.y=new we("y",e),this.y.mount(),this.x.mount(),this.x.applyTransform({scale:1,translateX:0,translateY:0}),this.y.applyTransform({scale:1,translateX:0,translateY:0})}}const Oi=t=>{const e=new be(t.observer);return{name:"ruler",data:e,install(){t.onTransform(()=>{e.x.applyTransform(t.transform),e.y.applyTransform(t.transform),e.x.meshUnmount(),e.y.meshUnmount()})},uninstall(){e.x.unmount(),e.y.unmount(),e.x.meshUnmount(),e.y.meshUnmount()}}};X.Ruler=be,X.ruler=Oi,Object.defineProperty(X,Symbol.toStringTag,{value:"Module"})});
